<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>APS University | Student Result Analysis</title>

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>

  <style>
    body {
      font-family: "Poppins", sans-serif;
      background-color: #f9f9f9;
    }

    /* ---------- HEADER ---------- */
    header {
      background-color: #002147;
      color: white;
      padding: 10px 0;
    }

    .header-container {
      display: flex;
      justify-content: space-between;
      align-items: center;
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
    }

    .header-left {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .header-left img {
      width: 65px;
      height: 65px;
      border-radius: 50%;
      background: white;
      padding: 4px;
      object-fit: cover;
    }

    .header-left h1 {
      font-size: 1.7rem;
      margin: 0;
      font-weight: 600;
      letter-spacing: 0.5px;
    }

    nav ul {
      list-style: none;
      display: flex;
      gap: 25px;
      margin: 0;
      padding: 0;
    }

    nav ul li a {
      color: white;
      text-decoration: none;
      font-weight: 500;
      transition: color 0.3s;
    }

    nav ul li a:hover {
      color: #00bfff;
    }

    /* ---------- SUB HEADER ---------- */
    .sub-header-box {
      background-color: #e6f0ff;
      color: #002147;
      padding: 25px;
      text-align: center;
      margin: 20px auto 40px;
      border-radius: 15px;
      max-width: 1100px;
    }

    .sub-header-box h2 {
      margin: 0;
      font-size: 1.5rem;
      font-weight: 600;
    }

    /* ---------- MAIN SECTION ---------- */
    .main-section {
      padding-bottom: 40px;
    }

    .section-title {
      color: #004aad;
      font-weight: 700;
      margin-top: 40px;
      text-align: center;
    }

    .card {
      border-radius: 15px;
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
    }

    th {
      background-color: #007bff !important;
      color: white;
    }

    .btn-primary {
      background: #007bff;
      border: none;
      transition: 0.3s;
    }

    .btn-primary:hover {
      background: #0056b3;
    }

    .btn-success {
      background: #28a745;
      border: none;
      transition: 0.3s;
    }

    .btn-success:hover {
      background: #1e7e34;
    }

    .btn-warning {
      background: #ffc107;
      border: none;
      transition: 0.3s;
    }

    .btn-warning:hover {
      background: #e0a800;
    }

    canvas {
      background: #fafafa;
      border-radius: 10px;
      padding: 10px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    }

    #tableSection {
      display: none;
    }

    /* ---------- FOOTER ---------- */
    footer {
      background-color: #111;
      color: #fff;
      padding: 40px 0 10px;
      font-size: 0.9rem;
    }

    .footer-logo {
      font-weight: bold;
      font-size: 1.2rem;
      margin-bottom: 10px;
    }

    .footer-section h6 {
      font-weight: 600;
      margin-bottom: 15px;
      color: #fff;
    }

    .footer-section ul {
      list-style: none;
      padding: 0;
    }

    .footer-section ul li a {
      color: #ccc;
      text-decoration: none;
      transition: color 0.3s;
    }

    .footer-section ul li a:hover {
      color: #fff;
    }

    /* üëá ‡§Ø‡§π‡§æ‡§Å footer-bottom ‡§Æ‡•á‡§Ç ‡§¨‡§¶‡§≤‡§æ‡§µ ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à */
    .footer-bottom {
      text-align: center;
      border-top: 1px solid #333;
      margin-top: 20px;
      padding-top: 10px;
      color: #007bff;     /* üîπ Blue color */
      font-weight: 700;   /* üîπ Bold text */
      font-size: 0.9rem;  /* üîπ ‡§µ‡§π‡•Ä size ‡§∞‡§ñ‡§æ ‡§ó‡§Ø‡§æ */
    }
  </style>
</head>
<body>

  <!-- HEADER -->
  <header>
    <div class="header-container">
      <div class="header-left">
        <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQCAoiUh6ZcPkTDhuulzHFt19SPOYwtnOOqJw&s" alt="APS Logo">
        <h1>APS University ‚Äì DASS</h1>
      </div>
      <nav>
        <ul>
          <li><a href="index.html">Home</a></li>
          <li><a href="about.html">About</a></li>
          <li><a href="form.html">Survey</a></li>
          <li><a href="asd.html" target="_blank">Service</a></li>
          <li><a href="https://www.kaggle.com/datasets">Resources</a></li>
          <li><a href="https://hindicurrentaffairs.adda247.com/">News</a></li>
          <li><a href="content.html">Contact</a></li>
          <li><a href="login.html">Login/Sign Up</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <!-- SUB HEADER -->
  <div class="container">
    <div class="sub-header-box">
      <h2>Welcome To ‚Äì Data Analytics for Student Success</h2>
    </div>
  </div>

  <!-- MAIN CONTENT -->
  <div class="container main-section">
    <section>
      <h2 class="section-title">üìä Student Data Analysis</h2>

      <div class="card p-4 mb-4" id="uploadSection">
        <h5 class="mb-3">Upload Student Data (Excel or CSV)</h5>
        <input type="file" id="fileInput" accept=".xlsx,.csv" class="form-control mb-3" />
        <button class="btn btn-primary" id="uploadBtn">Upload & Analyze</button>
      </div>

      <div id="tableSection" class="card p-4">
        <h4 class="text-center mb-3">üìã Uploaded Student Data</h4>
        <div id="tableContainer" class="table-responsive mb-4"></div>

        <div class="mb-3">
          <label for="columnSelect" class="form-label fw-bold">Select Column for Analysis:</label>
          <select id="columnSelect" class="form-select"></select>
        </div>

        <canvas id="chart" height="130"></canvas>

        <div class="mt-3">
          <button class="btn btn-primary me-2" onclick="printChart()">Print Chart</button>
          <button class="btn btn-success me-2" onclick="downloadChart()">Download Chart</button>
          <button class="btn btn-warning" onclick="downloadChart()">Save Chart</button>
        </div>
      </div>
    </section>
  </div>

  <!-- FOOTER -->
  <footer>
    <div class="container">
      <div class="row">
        <div class="col-md-5 footer-section">
          <div class="footer-logo">APS University</div>
          <p>The <strong>Data Analytics for Student Success (DASS)</strong> programme supports educators with learning analytics.</p>
        </div>

        <div class="col-md-4 footer-section">
          <h6>Quick Links</h6>
          <ul>
            <li><a href="converterr.html">DASS at a glance</a></li>
            <li><a href="excel.html">Services(excel)</a></li>
            <li><a href="result.html">Mock test analytics</a></li>
            <li><a href="report.html">Final Report</a></li>
          </ul>
        </div>

        <div class="col-md-3 footer-section">
          <h6>Contact</h6>
          <p>Email: <a href="mailto:dass@apsu.ac.in" class="text-white">dass@apsu.ac.in</a></p>
        </div>
      </div>

      <!-- üëá Footer bottom modified -->
      <div class="footer-bottom">
        Designed by- Vivek Singh,Amit Kewat & Mahesh Saket | Student Result Analyzer ¬© 2026
      </div>
    </div>
  </footer>

  <script>
    // Upload & Analyze
    document.getElementById("uploadBtn")?.addEventListener("click", () => {
      const fileInput = document.getElementById("fileInput");
      const file = fileInput.files[0];
      if (!file) { alert("Please choose a file first!"); return; }

      const reader = new FileReader();
      reader.onload = function (e) {
        const data = new Uint8Array(e.target.result);
        const workbook = XLSX.read(data, { type: "array" });
        const sheetName = workbook.SheetNames[0];
        const worksheet = workbook.Sheets[sheetName];
        const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });
        displayTable(jsonData);
      };
      reader.readAsArrayBuffer(file);
    });

    function displayTable(data) {
      if (!data.length) return;

      document.getElementById("uploadSection").style.display = "none";
      document.getElementById("tableSection").style.display = "block";

      const headers = data[0];
      const rows = data.slice(1);

      let html = "<table class='table table-bordered table-striped text-center'><thead><tr>";
      headers.forEach(h => html += `<th>${h}</th>`);
      html += "</tr></thead><tbody>";
      rows.forEach(r => {
        html += "<tr>";
        r.forEach(c => html += `<td>${c}</td>`);
        html += "</tr>";
      });
      html += "</tbody></table>";
      document.getElementById("tableContainer").innerHTML = html;

      const select = document.getElementById("columnSelect");
      select.innerHTML = "";
      headers.forEach((h, i) => {
        const opt = document.createElement("option");
        opt.value = i;
        opt.textContent = h;
        select.appendChild(opt);
      });

      const autoColumnIndex = headers.findIndex(h => h.toLowerCase().includes("pass")) !== -1
        ? headers.findIndex(h => h.toLowerCase().includes("pass"))
        : headers.findIndex(h => h.toLowerCase().includes("grade"));

      if (autoColumnIndex !== -1) {
        drawChart(autoColumnIndex, headers, rows);
        select.value = autoColumnIndex;
      }

      select.addEventListener("change", () => {
        const colIndex = select.value;
        drawChart(colIndex, headers, rows);
      });
    }

    function drawChart(colIndex, headers, rows) {
      const columnData = rows.map(r => r[colIndex]);
      const counts = {};
      columnData.forEach(v => counts[v] = (counts[v] || 0) + 1);

      const labels = Object.keys(counts);
      const values = Object.values(counts);

      const ctx = document.getElementById("chart").getContext("2d");
      if (window.myChart) window.myChart.destroy();

      const type = headers[colIndex].toLowerCase().includes("pass") ||
                   headers[colIndex].toLowerCase().includes("grade") ? "pie" : "bar";

      window.myChart = new Chart(ctx, {
        type: type,
        data: { labels, datasets: [{ label: headers[colIndex], data: values,
          backgroundColor: [
            "rgba(54, 162, 235, 0.7)",
            "rgba(255, 99, 132, 0.7)",
            "rgba(255, 206, 86, 0.7)",
            "rgba(75, 192, 192, 0.7)",
            "rgba(153, 102, 255, 0.7)",
            "rgba(255, 159, 64, 0.7)",
          ], borderWidth: 1 }] },
        options: { responsive: true,
          plugins: { legend: { position: "top" }, title: { display: true, text: "Data Analysis Chart" } },
          scales: type === "bar" ? { y: { beginAtZero: true } } : {} }
      });
    }

    function printChart() {
      const canvas = document.getElementById("chart");
      const dataUrl = canvas.toDataURL();
      const w = window.open('', '_blank');
      w.document.write(`<img src="${dataUrl}" style="width:100%">`);
      w.document.close();
      w.print();
    }

    function downloadChart() {
      const canvas = document.getElementById("chart");
      const link = document.createElement('a');
      link.href = canvas.toDataURL("image/png");
      link.download = "StudentChart.png";
      link.click();
    }
  </script>
  <!-- ================= CHATBOT START ================= -->

<style>
#apsChatToggle {
  position: fixed;
  right: 20px;
  bottom: 20px;
  background: #004aad;
  color: white;
  width: 60px;
  height: 60px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 26px;
  cursor: pointer;
  z-index: 9999;
  box-shadow: 0 5px 15px rgba(0,0,0,0.3);
}

#apsChatbot {
  position: fixed;
  right: 20px;
  bottom: 90px;
  width: 360px;
  background: white;
  border-radius: 15px;
  box-shadow: 0 5px 20px rgba(0,0,0,0.3);
  display: none;
  overflow: hidden;
  z-index: 9999;
  font-family: "Poppins", sans-serif;
}

#apsChatHeader {
  background: #002147;
  color: white;
  padding: 12px;
  text-align: center;
  font-weight: 600;
}

#apsChatBox {
  height: 320px;
  overflow-y: auto;
  padding: 10px;
  background: #f5f7fa;
}

.apsMsg {
  margin: 6px 0;
  padding: 8px;
  border-radius: 8px;
  font-size: 14px;
  white-space: pre-line;
}

.apsUser {
  background: #007bff;
  color: white;
  text-align: right;
}

.apsBot {
  background: #e9ecef;
}

#apsInputArea {
  display: flex;
  padding: 5px;
  background: #ddd;
}

#apsInputArea input {
  flex: 1;
  padding: 6px;
  border-radius: 5px;
  border: none;
}

#apsInputArea button {
  margin-left: 4px;
  border: none;
  padding: 6px;
  cursor: pointer;
  border-radius: 5px;
}
</style>

<div id="apsChatToggle" onclick="apsToggleChat()">üí¨</div>

<div id="apsChatbot">
  <div id="apsChatHeader">DASS Help Assistant</div>
  <div id="apsChatBox"></div>
  <div id="apsInputArea">
    <input type="text" id="apsInput" placeholder="Ask something...">
    <button onclick="apsVoice()">üé§</button>
    <button onclick="apsSwitchLang()">üåê</button>
    <button onclick="apsSend()">‚û§</button>
  </div>
</div>

<script>
let apsLang = "en";

function apsToggleChat(){
  const bot = document.getElementById("apsChatbot");
  bot.style.display = bot.style.display === "none" ? "block" : "none";
}

function apsAddMsg(text,type){
  const box = document.getElementById("apsChatBox");
  const div = document.createElement("div");
  div.className = "apsMsg " + type;
  div.innerText = text;
  box.appendChild(div);
  box.scrollTop = box.scrollHeight;
}

function apsSend(){
  const input = document.getElementById("apsInput");
  const msg = input.value.trim();
  if(!msg) return;
  apsAddMsg(msg,"apsUser");
  apsReply(msg.toLowerCase());
  input.value="";
}

function apsReply(msg){

let en="I'm here to help üòä Ask about Excel upload, Survey, Converter, Resources or Graph download.";
let hi="‡§Æ‡•à‡§Ç ‡§Ü‡§™‡§ï‡•Ä ‡§∏‡§π‡§æ‡§Ø‡§§‡§æ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ø‡§π‡§æ‡§Å ‡§π‡•Ç‡§Å üòä Excel upload, Survey, Converter, Resources ‡§Ø‡§æ Graph download ‡§ï‡•á ‡§¨‡§æ‡§∞‡•á ‡§Æ‡•á‡§Ç ‡§™‡•Ç‡§õ‡•á‡§Ç‡•§";

if(msg.includes("hi")||msg.includes("hello")){
en="Hello üëã This platform analyzes student data using Excel or Survey.\nYou can upload Excel, convert PDF to Excel, generate graphs and download reports.";
hi="‡§®‡§Æ‡§∏‡•ç‡§§‡•á üëã ‡§Ø‡§π ‡§™‡•ç‡§≤‡•á‡§ü‡§´‡•â‡§∞‡•ç‡§Æ Excel ‡§Ø‡§æ Survey ‡§∏‡•á ‡§õ‡§æ‡§§‡•ç‡§∞ ‡§°‡•á‡§ü‡§æ ‡§ï‡§æ ‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§\n‡§Ü‡§™ Excel ‡§Ö‡§™‡§≤‡•ã‡§° ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç, PDF ‡§ï‡•ã Excel ‡§Æ‡•á‡§Ç ‡§¨‡§¶‡§≤ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç ‡§î‡§∞ ‡§ó‡•ç‡§∞‡§æ‡§´ ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§";
}

else if(msg.includes("excel")){
en="Only Excel (.xlsx/.csv) files are accepted.\nIf you don't have Excel file, use PDF to Excel Converter.";
hi="‡§ï‡•á‡§µ‡§≤ Excel (.xlsx/.csv) ‡§´‡§º‡§æ‡§á‡§≤ ‡§∏‡•ç‡§µ‡•Ä‡§ï‡§æ‡§∞ ‡§ï‡•Ä ‡§ú‡§æ‡§§‡•Ä ‡§π‡•à‡•§\n‡§Ø‡§¶‡§ø Excel ‡§´‡§º‡§æ‡§á‡§≤ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à ‡§§‡•ã PDF to Excel Converter ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡•á‡§Ç‡•§";
}

else if(msg.includes("convert")){
en="Use Converter option to convert PDF to Excel.\nAfter converting upload file for analysis.";
hi="Converter ‡§µ‡§ø‡§ï‡§≤‡•ç‡§™ ‡§∏‡•á PDF ‡§ï‡•ã Excel ‡§Æ‡•á‡§Ç ‡§¨‡§¶‡§≤‡•á‡§Ç ‡§î‡§∞ ‡§´‡§ø‡§∞ ‡§Ö‡§™‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç‡•§";
}

else if(msg.includes("download")){
en="You can download graphs as PNG image and print them easily.";
hi="‡§Ü‡§™ ‡§ó‡•ç‡§∞‡§æ‡§´ ‡§ï‡•ã PNG ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° ‡§Ø‡§æ ‡§™‡•ç‡§∞‡§ø‡§Ç‡§ü ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§";
}

else if(msg.includes("resources")){
en="Resources section provides large datasets related to Data Science, History and Visualization.";
hi="Resources ‡§∏‡•á‡§ï‡•ç‡§∂‡§® ‡§Æ‡•á‡§Ç Data Science ‡§î‡§∞ ‡§Ö‡§®‡•ç‡§Ø ‡§µ‡§ø‡§∑‡§Ø‡•ã‡§Ç ‡§∏‡•á ‡§ú‡•Å‡§°‡§º‡•á ‡§¨‡§°‡§º‡•á ‡§°‡§æ‡§ü‡§æ‡§∏‡•á‡§ü ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§π‡•à‡§Ç‡•§";
}

setTimeout(()=>{
apsAddMsg(apsLang==="en"?en:hi,"apsBot");
},500);
}

function apsSwitchLang(){
apsLang = apsLang==="en"?"hi":"en";
alert("Language switched to "+(apsLang==="en"?"English":"Hindi"));
}

function apsVoice(){
if (!('webkitSpeechRecognition' in window)) {
alert("Voice not supported");
return;
}
let recognition = new webkitSpeechRecognition();
recognition.lang = apsLang==="en"?"en-US":"hi-IN";
recognition.start();
recognition.onresult=function(event){
document.getElementById("apsInput").value=event.results[0][0].transcript;
};
}
</script>

<!-- ================= CHATBOT END ================= -->
</body>
</html>










